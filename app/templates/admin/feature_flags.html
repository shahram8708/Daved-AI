
{% extends "base.html" %}

{% block title %}Feature Flags · Daved AI{% endblock %}

{% block content %}
<svg aria-hidden="true" class="d-none">
  <defs>
    <filter id="glow" x="-40%" y="-40%" width="180%" height="180%"><feGaussianBlur stdDeviation="3.5" result="coloredBlur"/><feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
    <symbol id="i-toggle" viewBox="0 0 24 24"><rect x="1" y="7" width="22" height="10" rx="5" fill="none" stroke="currentColor" stroke-width="2"/><circle cx="8" cy="12" r="4" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="i-plus" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none"/></symbol>
  </defs>
</svg>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
  :root{ --bg:#0b0f1a; --card:#121a2d; --text:#d7e3ff; --muted:#9bb0d8; --grad-1:#6a00ff; --grad-2:#00e1ff; }
  body{ background: radial-gradient(1200px 600px at 10% -10%, #1a2341 0%, transparent 60%), var(--bg); color:var(--text); font-family: Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; }
  .badge-chip{ display:inline-flex; align-items:center; gap:.5rem; padding:.35rem .65rem; border-radius:999px; background:rgba(124,77,255,.12); border:1px solid rgba(124,77,255,.25); color:var(--muted); font-weight:600; font-size:.9rem;}
  .panel{ background: linear-gradient(180deg, rgba(255,255,255,.02),rgba(255,255,255,0)), var(--card); border:1px solid rgba(255,255,255,.06); border-radius:16px; position:relative; overflow:hidden; transition: transform .35s cubic-bezier(.2,.8,.2,1), box-shadow .35s, border-color .35s;}
  .panel:hover{ transform:translateY(-4px); box-shadow:0 16px 60px rgba(0,0,0,.35),0 0 60px rgba(124,77,255,.15); border-color:rgba(124,77,255,.35);}
  .panel-header{ border-bottom:1px solid rgba(255,255,255,.06); background:#0b1224; padding:.9rem 1rem; }
  .panel-title{ margin:0; display:flex; align-items:center; gap:.6rem; font-weight:700; }
  .ico{ width:40px; height:40px; display:grid; place-items:center; border-radius:12px; color:#fff; background:radial-gradient(circle at 30% 30%, rgba(36,225,255,.25), rgba(124,77,255,.45)); filter:url(#glow); }
  .table-dark-glass{ --bs-table-bg: transparent; --bs-table-color:var(--text); }
  .table-dark-glass td,.table-dark-glass th{ border-color: rgba(255,255,255,.06); vertical-align:middle; }
  .table-dark-glass tbody tr:hover{ background: rgba(124,77,255,.08); transform: translateY(-1px); }
  .badge-soft{ border:1px solid rgba(255,255,255,.12); padding:.35rem .6rem; border-radius:999px; font-weight:600; }
  .badge-enabled{ background: rgba(46,204,113,.15); color:#aef0c8; border-color: rgba(46,204,113,.35); }
  .badge-disabled{ background: rgba(255,255,255,.08); color:#d7e3ff; }
  .reveal{ opacity:0; transform: translateY(18px) scale(.98); transition: opacity .7s ease, transform .7s ease; }
  .reveal.in-view{ opacity:1; transform:none; }
  .btn-solid{ background: linear-gradient(135deg,var(--grad-1),var(--grad-2)); border:0; color:#fff; box-shadow:0 6px 30px rgba(124,77,255,.35); }
  .btn-solid:hover{ filter:brightness(1.08); transform:translateY(-2px); }
  .filter-input{ background:#0e162b; border:1px solid rgba(255,255,255,.08); color:var(--text); border-radius:12px; }
  .filter-input:focus{ border-color: rgba(36,225,255,.6); box-shadow: 0 0 0 .25rem rgba(36,225,255,.15); background:#0f182f; }
  .page-sub{ color:var(--muted); }
</style>

<section class="position-relative py-4">
  <div class="container">
    <div class="reveal">
      <span class="badge-chip mb-2"><svg class="me-1" width="18" height="18"><use href="#i-toggle"></use></svg> Daved AI · Admin</span>
      <h1 class="page-title fw-800 mb-0">Feature Flags</h1>
      <p class="page-sub mb-0">Quickly enable or disable capabilities across the platform.</p>
    </div>
  </div>
</section>

<section class="py-3 py-md-4">
  <div class="container">
    <div class="panel reveal">
      <div class="panel-header">
        <h5 class="panel-title"><span class="ico"><svg width="22" height="22"><use href="#i-toggle"></use></svg></span> Manage Feature Flags</h5>
      </div>
      <div class="p-3 p-md-4">
        
        <div class="table-responsive">
          <table class="table table-dark-glass align-middle" id="flags-table">
            <thead>
              <tr>
                <th class="text-uppercase small" style="color:#9bb0d8">Name</th>
                <th class="text-uppercase small" style="color:#9bb0d8">Description</th>
                <th class="text-uppercase small" style="color:#9bb0d8">Status</th>
                <th class="text-end text-uppercase small" style="color:#9bb0d8">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for flag in flags %}
              <tr data-name="{{ flag.name|lower }}" data-status="{{ 'enabled' if flag.is_enabled else 'disabled' }}">
                <td><strong>{{ flag.name }}</strong></td>
                <td class="text-break">{{ flag.description }}</td>
                <td>
                  {% if flag.is_enabled %}
                    <span class="badge-soft badge-enabled">Enabled</span>
                  {% else %}
                    <span class="badge-soft badge-disabled">Disabled</span>
                  {% endif %}
                </td>
                <td class="text-end">
                  <form method="POST" action="{{ url_for('admin.toggle_feature_flag', flag_id=flag.id) }}" class="d-inline">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-sm btn-solid rounded-pill">
                      {% if flag.is_enabled %}Disable{% else %}Enable{% endif %}
                    </button>
                  </form>
                </td>
              </tr>
              {% else %}
              <tr>
                <td colspan="4" class="text-center py-4">
                  <div class="ico mx-auto mb-3" style="width:56px;height:56px;"><svg width="26" height="26"><use href="#i-toggle"></use></svg></div>
                  <p class="mb-0 page-sub">No feature flags defined</p>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        
        <div class="mt-4 p-3 p-md-4 rounded-3" style="background:#0f1526; border:1px solid rgba(255,255,255,.06);">
          <h5 class="mb-3 d-flex align-items-center gap-2">
            <svg width="20" height="20"><use href="#i-plus"></use></svg> Create New Feature Flag
          </h5>
          <form method="POST" action="{{ url_for('admin.create_feature_flag') }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <div class="row g-3">
              <div class="col-md-4">
                <input type="text" name="name" class="form-control filter-input" placeholder="Flag Name" required>
              </div>
              <div class="col-md-5">
                <input type="text" name="description" class="form-control filter-input" placeholder="Description">
              </div>
              <div class="col-md-3">
                <button type="submit" class="btn btn-solid w-100 rounded-pill">Create Flag</button>
              </div>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>
</section>

<script>
  const rEls=document.querySelectorAll('.reveal'); const io=new IntersectionObserver((es)=>es.forEach(e=>{if(e.isIntersecting){e.target.classList.add('in-view'); io.unobserve(e.target);}}),{threshold:.15}); rEls.forEach(el=>io.observe(el));
</script>
{% endblock %}
